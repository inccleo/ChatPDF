<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“åˆ›æ–‡æ¡£åŠ©æ‰‹ - æ‚¨é˜…è¯»æ–‡æ¡£çš„å¥½å¸®æ‰‹</title>
    <script type="module" crossorigin="" src="static/js/index-82138e4a.js"></script>
    <style>[v-clock]{
        display:none !important;
    }</style>
    <link rel="stylesheet" href="static/css/index-c4379658.css">
</head>

<body >
    <div id="root" data-v-app="" v-clock>
        <main data-v-7cf59f00="">
            <!-- logo -->
            <div data-v-7cf59f00="" class="logo">
                <img data-v-7cf59f00="" src="./static/images/logo.png" alt="logo" width="100">
            </div>

            <section data-v-b6abd06f="" class="el-container is-vertical" style="max-width: 960px; margin: 0px auto;">
                <h1 data-v-b6abd06f=""> å“åˆ›æ–‡æ¡£åŠ©æ‰‹ <br data-v-b6abd06f=""> åªéœ€ä¸Šä¼ æ–‡æ¡£ AIè‡ªåŠ¨åˆ†æå¹¶å›ç­”ä½ çš„é—®é¢˜ </h1>
                <main data-v-b6abd06f="" class="el-main">
                    <el-card shadow="never" style="width: 100%">
                        <el-upload
                        class="upload-demo"
                        drag
                        accept=".pdf"
                        action="/api/doc/upload"
                        :file-list="fileList"
                        :on-success="uploadText"
                        :on-preview="handlePreViewFile"
                        :multiple="false">
                        <i class="el-icon-upload"></i>
                        <div class="el-upload__text">å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<em>ç‚¹å‡»ä¸Šä¼ </em></div>
                        <div class="el-upload__tip" slot="tip">ç›®å‰ä»…æ”¯æŒ.pdfæ–‡ä»¶</div>
                        </el-upload>
                    </el-card>
                    <!---->
                    <div data-v-f9cc3aca="" data-v-b6abd06f="" class="el-row introduction" style="margin-left: -10px; margin-right: -10px;">
                        <div data-v-f9cc3aca="" class="el-col el-col-24 el-col-xs-24 el-col-sm-8 is-guttered" style="padding-right: 10px; padding-left: 10px;">
                            <div data-v-f9cc3aca="" class="el-card is-never-shadow box-card">
                                <!--v-if-->
                                <div class="el-card__body" style="">
                                    <h3 data-v-f9cc3aca="">å¯¹äºå­¦ç”Ÿ ğŸ“</h3>
                                    <p data-v-f9cc3aca="">è¯¾ç¨‹å¤ªå¤æ‚æˆ–èµ„æ–™å¤ªå¤šäº†ï¼Ÿè¿™é‡Œå¯ä»¥å›ç­”æ‚¨å…³äºæ•™æã€è®²ä¹‰å’Œ PPT ä¸­çš„å†…å®¹ï¼Œä¸å¿…èŠ±è´¹å¤§é‡æ—¶é—´åœ¨èµ„æ–™æ£€ç´¢ä¸Šã€‚</p>
                                    <p data-v-f9cc3aca="">è®ºæ–‡èµ„æ–™å¤ªå¤šå¤ªæ‚ï¼Ÿä¸Šä¼ æ–‡æ¡£ï¼Œæ‰¾åˆ°æ‚¨éœ€è¦çš„ä¿¡æ¯ï¼Œå¿«é€Ÿå®Œæˆå­¦æœ¯è®ºæ–‡ï¼Œçœå¿ƒçœåŠ›ã€‚</p>
                                </div>
                            </div>
                        </div>
                        <div data-v-f9cc3aca="" class="el-col el-col-24 el-col-xs-24 el-col-sm-8 is-guttered" style="padding-right: 10px; padding-left: 10px;">
                            <div data-v-f9cc3aca="" class="el-card is-never-shadow box-card">
                                <!--v-if-->
                                <div class="el-card__body" style="">
                                    <h3 data-v-f9cc3aca="">åœ¨å·¥ä½œä¸­ ğŸ¢</h3>
                                    <p data-v-f9cc3aca="">é«˜æ•ˆæ£€ç´¢æ–‡æ¡£ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºå•†ä¸šåˆ†ææŠ¥å‘Šã€åŸ¹è®­ææ–™å’Œæ³•å¾‹æ–‡ä»¶ï¼Œæ‚¨çš„é—®é¢˜å¯ä»¥å¿«é€Ÿå¾—åˆ°è§£ç­”ï¼Œä¸å¿…å†ç¿»é˜…ä¸Šç™¾é¡µçš„æ–‡æ¡£æ‰¾ä¿¡æ¯</p>
                                    <p data-v-f9cc3aca="">AI çš„å›ç­”ä¼šå°†æ¥æºé¡µç æ ‡æ³¨å‡ºæ¥ï¼Œä¾¿äºæ‚¨å›æŸ¥åŸæ–‡ã€‚</p>
                                </div>
                            </div>
                        </div>
                        <div data-v-f9cc3aca="" class="el-col el-col-24 el-col-xs-24 el-col-sm-8 is-guttered" style="padding-right: 10px; padding-left: 10px;">
                            <div data-v-f9cc3aca="" class="el-card is-never-shadow box-card">
                                <!--v-if-->
                                <div class="el-card__body" style="">
                                    <h3 data-v-f9cc3aca="">å…³äº å“åˆ›æ–‡æ¡£åŠ©æ‰‹</h3>
                                    <p data-v-f9cc3aca="">æ— é™æ™ºæ…§ï¼Œæ— é™å¯èƒ½ã€‚æˆ‘ä»¬çš„AIå°†å¸®åŠ©æ‚¨å¿«é€Ÿå›ç­”ä»»ä½•é—®é¢˜ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚æˆ‘ä»¬çš„äº§å“ä¸“é—¨é’ˆå¯¹ä¸­æ–‡ç”¨æˆ·åšäº†ä¼˜åŒ–,ä¸­æ–‡å‹å¥½å‹äº§å“</p>
                                    <p data-v-f9cc3aca="">æ‚¨çš„æ‰€æœ‰å¯¹è¯è®°å½•å‡å­˜å‚¨åœ¨æœ¬åœ°ï¼ŒæœåŠ¡å™¨ä¸ä¼šè®°å½•ï¼Œç¡®ä¿æ‚¨çš„éšç§ã€‚</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
                <footer data-v-b6abd06f="" class="el-footer">
                    <div data-v-9098797a="" style="text-align: center; color: black;">
                        <a data-v-9098797a="" class="el-link el-link--default is-underline">                          
                        <!-- è”ç³»æˆ‘ä»¬ ç‚¹å¢åŠ å‡»äº‹ä»¶ --> 
                        <a data-v-9098797a="" class="el-link el-link--default is-underline">
                            <span v-on:click="handleClick" data-v-9098797a="">è”ç³»æˆ‘ä»¬</span>
                        </a>


                    <div class="el-overlay" style="z-index: 2001; display: none;">
                        <div role="dialog" aria-modal="true" aria-label="ä»·æ ¼ - å®Œå…¨å…è´¹" aria-describedby="el-id-6420-0" class="el-overlay-dialog"></div>
                    </div>
                    <div class="el-overlay" style="z-index: 2002; display: none;">
                        <div role="dialog" aria-modal="true" aria-label="æçŒ®ä½œè€…" aria-describedby="el-id-6420-1" class="el-overlay-dialog" style="display: flex;"></div>
                    </div>
                    <div class="el-overlay" style="z-index: 2003; display: none;">
                        <div role="dialog" aria-modal="true" aria-label="è”ç³»æˆ‘ä»¬" aria-describedby="el-id-6420-2" class="el-overlay-dialog"></div>
                    </div>
                </footer>
            </section>
            <div class="el-overlay" style="z-index: 2004; display: none;">
                <div role="dialog" aria-modal="true" aria-label="å‘ AI æé—® > " aria-describedby="el-id-6420-3" class="el-overlay-dialog" style="display: flex;"></div>
            </div>
        </main>

        <el-dialog :title="'å‘ AI æé—® >' + uploadName" :visible.sync="dialogTableVisible" width="65%" :close-on-click-modal="false" :close-on-press-escape="false" >
            <div v-loading="asyLoading" 
            element-loading-text="åˆ†æä¸­"
            element-loading-spinner="el-icon-loading"
            element-loading-background="#fff">
                <el-alert
                    style="color: #333;"
                    class="chat-message assistant"
                    style="margin-bottom:15px;"
                    :title="summary"
                    type="info">
                </el-alert>

                <div >
                    <div class="chat-message-question" style="margin-bottom:15px;">ä»¥ä¸‹æ˜¯å‡ ä¸ªä½ å¯èƒ½æ„Ÿå…´è¶£çš„é—®é¢˜ï¼š</div>

                    <div class="chat-message-question" style="margin-bottom:15px;" v-for="(item, index) in questions" :key="index">
                        <el-link type="primary" @click="linkToChat(item)">{{ item }}ï¼Ÿ</el-link>
                    </div>
                    
                </div>

                <div style="min-height: 15em;max-height: 25em;
                overflow-y: auto;" id="scroll-to-bottom">
                    <div v-for="(item,index) in list" :key="index">
                        <div class="chat-message chat-message-user" v-if="item.user">
                            <div class="chat-message-row">
                                <span>{{ item.txt }}</span>
                            </div>
                        </div>
    
                        <div class="chat-message chat-message-chatgpt" v-else>
                            <div style="width:50px;height:50px;" v-if="item.isLoading">
                                <i class="el-icon-loading"></i>                                
                            </div>
                            <div class="chat-message-row gpt" v-html="markerHtml(item.txt)" v-else>
                            </div>
                        </div>
                    </div>
                    

                </div>
                
                <el-form @submit.native.prevent>
                    <el-input @keyup.enter.native="onChat()" placeholder="è¯·è¾“å…¥å†…å®¹" v-model="searchVal" class="input-with-select" >                    
                        <el-button slot="append" icon="el-icon-s-promotion" @click="onChat()"></el-button>
                    </el-input>
                <el-form>
                

            </div>
        </el-dialog>
    </div>
</body>

</html>
<script src="https://cdn.bootcss.com/vue/2.5.2/vue.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/element-ui/2.15.13/index.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/marked/4.2.12/marked.min.js"></script>
<link href="https://cdn.bootcdn.net/ajax/libs/element-ui/2.15.13/theme-chalk/index.css" rel="stylesheet">
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script>
    new Vue({
      el: '#root',
      filter: {
        
      },
      data: function () {
        return {
          uri: '/api',
          uploadName: '',
          sysTitle: '',
          asyLoading: false,
          searchVal: '',
          fileList: [],
          list : [],
          token: '',
          summary: '',
          questions: [],
          dialogTableVisible: false,
          aa: '<p>æ’åç¬¬å››çš„æˆ˜é˜ŸWBGå–å¾—äº†10ä¸ªèƒœåˆ©</p>',
          name: 'Amy',
          school: {
            name: 'æˆ‘è¦è‡ªå­¦ç½‘',
            course: 'ps',
            url: 'https://www.51zxw.net/'
          }
        }
      },
      methods: {
        handleClick: function () {
            //element-ui å¼¹çª—æ˜¾ç¤ºå¾®ä¿¡ç¾¤äºŒç»´ç 
            this.$alert('<img src="./static/images/wechat.jpg" width="400" height="350" />', 'è”ç³»æˆ‘ä»¬', {
                dangerouslyUseHTMLString: true,
                confirmButtonText: 'ç¡®å®š',
                callback: action => {
                }
            });
            
            
        },
        scrollBottom: function(element) {
			element.scroll({ top: element.scrollHeight, behavior: "smooth"})
		},
        scoller: function () {
            let scroll_to_bottom = document.getElementById('scroll-to-bottom');
            scrollBottom(scroll_to_bottom)
        },   
        linkToChat: function (searchVal) {
            this.onChat(searchVal)
        },
        getWords: function(apiResponse) {
            // æå–æ‘˜è¦
            this.summary = apiResponse.summary
            this.questions = apiResponse.questions                   
                                    
        },
        handlePreViewFile() {
            this.dialogTableVisible = true          
            this.handleAnalyse() 
        },
        // åˆ†æ
        handleAnalyse: function () {
            var that = this
            this.asyLoading = true
            $.post(this.uri + '/doc/analyse', {token: this.token}, function (res) {
                let jsd = JSON.parse(res.data.questions)  
                that.asyLoading = false                          
                that.getWords(jsd)
            })
            
           
        },
        uploadText: function (res, file) {
            this.token = res.data.token   
            this.uploadName = res.data.filename  
            this.dialogTableVisible = true          
            this.handleAnalyse()         
        },
        onChat: function (searchVal) {
            // if (this.isLoading) {
            //     this.$message.warning('è¯·ç­‰å¾…å›å¤..')
            //     return
            // }
            if (!this.searchVal && !searchVal) {
                this.$message.warning('è¯·è¾“å…¥é—®é¢˜')
                return
            }
            
            var that = this
            that.list.push({
                user: true,
                txt: searchVal || this.searchVal
            })
            that.list.push({
                user: false,
                txt: '',
                isLoading: true
            })
            this.isLoading = true
            var q = searchVal || this.searchVal
            that.searchVal = ''
            $.post(this.uri + '/doc/question', {  q: q, token: this.token}, function (res) {     
                
                that.$set(that.list, that.list.length - 1, {
                    user: false,
                        txt: res.data.answer,
                        isLoading: false
                })     
                that.$nextTick( function () {
                    that.scoller()
                })   
                that.isLoading = false             
            })
        },
        markerHtml: function (val) {            
            return marked.parse(val)
        }
      }
    });
</script>
<style>
    .logo{
        /* å›ºå®šå®šä½ */
        position: fixed;
        /* å®šä½ç‚¹ä¸ºå³ä¸‹è§’ */
        left: 100px;
        top: 20px;
    }
    .el-upload-dragger {width: 100%;padding: 0;}
    .el-upload {width: 100%;}
    .el-dialog__headerbtn {
        top: 0;
        right: 0;
    }
    .s-loading {
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 0 4px rgba(0,0,0,.3);
        border-radius: 5px;
        font-size: 16px;
    }
    .chat-message-user {
        display: flex;    
        justify-content: flex-end;
    }
    .chat-message-row {
        display: inline-block;
        background-color: #0a65ef;
        border: 1px solid #e3e3e3;
        box-shadow: 0 0 3px #d1d2da;
        color: #fff;
        padding: 10px;
        border-radius: 10px;
    }
    .chat-message-chatgpt {
        display: flex;    
        justify-content: flex-start;
    }
    .chat-message-row.gpt {
        background-color: #f9f9f9;
        border: 1px solid #e3e3e3;
        box-shadow: 0 0 3px #d1d2da;
        color: #000;
    }
    .el-input-group__append {border: 0;}
    .chat-message {margin-bottom: 15px;}
    .el-button--default {
        padding-bottom: 0;
        padding-top: 0;
    }
    .el-icon-thumb {
        font-size: 16px;
    }
</style>